<!doctype html>
<html lang="cs">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>Perky - Skill Tree</title>
    <link rel="stylesheet" href="perky.css">
    <script src="supabase_stub.js"></script>
    <link rel="stylesheet" href="menu.css">
    <link rel="stylesheet" href="mobile.css">
    <script src="menu.js" defer></script>
    <link rel="stylesheet" href="sf_scale.css">
    <script src="sf_scale.js"></script>
    <link rel="stylesheet" href="global.css">
<script src="lang_pack.js"></script>
</head>
<body>
<audio id="bgMusic" src="go.mp3" loop preload="auto"></audio>

<div class="layout">

  <!-- LEVÃ‰ PANEL -->
  <aside class="left-panel">
  
</aside>

  <!-- PERKY AREA -->
  <main class="perky-area">

    <!-- NÃZEV -->
    <div class="perky-title">ğŸŒ³ STROM PERKÅ® ğŸŒ³</div>

    <div class="perky-container">

      <!-- LEVÃ ÄŒÃST - INFO & STATS -->
      <div class="perky-info-section" id="perkyInfoSection">
        <div class="section-header">
          <h2>ğŸ“Š INFO</h2>
        </div>

        <div class="character-info-card">
          <div class="char-avatar-wrapper">
            <img src="avatar.jpg" alt="character" id="charAvatar" class="char-avatar">
            <div class="char-class-badge" id="charClassBadge">ğŸ‘»</div>
          </div>
          <div class="char-details">
            <div class="char-name" id="charName">BORIS GOPNIKOV</div>
            <div class="char-class-name" id="charClassName">PADOUCH</div>
            <div class="char-level">Level <span id="charLevel">1</span></div>
          </div>
        </div>

        <div class="perk-stats-row">
          <div class="perk-stat-box">
            <div class="perk-stat-label">OdemÄenÃ© perky</div>
            <div class="perk-stat-value" id="unlockedPerksCount">0</div>
          </div>
          <div class="perk-stat-box">
            <div class="perk-stat-label">Celkem perkÅ¯</div>
            <div class="perk-stat-value" id="totalPerksCount">50</div>
          </div>
        </div>

        <div class="perk-points-card">
          <div class="perk-points-label">ğŸ’ DOSTUPNÃ‰ BODY PERKÅ®</div>
          <div class="perk-points-value" id="perkPoints">5</div>
          <div class="perk-points-info">ZÃ­skÃ¡vÃ¡Å¡ 1 bod kaÅ¾dÃ© 2 levely</div>
        </div>

        <div class="stats-summary">
          <div class="stat-summary-item">
            <span class="stat-icon">âš”ï¸</span>
            <span class="stat-label">SÃ­la</span>
            <span class="stat-value" id="statStr">18</span>
          </div>
          <div class="stat-summary-item">
            <span class="stat-icon">ğŸ›¡ï¸</span>
            <span class="stat-label">Obrana</span>
            <span class="stat-value" id="statDef">14</span>
          </div>
          <div class="stat-summary-item">
            <span class="stat-icon">ğŸ¯</span>
            <span class="stat-label">Obratnost</span>
            <span class="stat-value" id="statDex">12</span>
          </div>
          <div class="stat-summary-item">
            <span class="stat-icon">ğŸ§ </span>
            <span class="stat-label">Inteligence</span>
            <span class="stat-value" id="statInt">12</span>
          </div>
          <div class="stat-summary-item">
            <span class="stat-icon">ğŸ’ª</span>
            <span class="stat-label">VÃ½drÅ¾</span>
            <span class="stat-value" id="statCon">16</span>
          </div>
          <div class="stat-summary-item">
            <span class="stat-icon">ğŸ€</span>
            <span class="stat-label">Å tÄ›stÃ­</span>
            <span class="stat-value" id="statLuck">9</span>
          </div>
        </div>

        <button class="reset-perks-btn" id="resetPerksBtn">
          ğŸ”„ RESETOVAT PERKY (10 cig)
        </button>
      </div>

      <!-- PROSTÅ˜EDNÃ ÄŒÃST - PERK TREE (now full width) -->
      <div class="perky-tree-section">
        <div class="section-header">
          <h2 id="treeTitle">ğŸŒ³ PADOUCH - STROM PERKÅ®</h2>
          <div class="tree-controls">
            <button class="tree-zoom-btn" id="zoomInBtn">ğŸ”+</button>
            <button class="tree-zoom-btn" id="zoomOutBtn">ğŸ”-</button>
            <button class="tree-reset-btn" id="resetViewBtn">â†»</button>
          </div>
        </div>

        <div class="tree-scroll-wrapper" id="treeScrollWrapper">
          <div class="tree-canvas" id="treeCanvas">
            <!-- Perk nodes will be rendered here by JS -->
          </div>
        </div>
      </div>

    </div>

  </main>

</div>

<!-- PERK DETAIL MODAL -->
<div class="perk-modal" id="perkModal">
  <div class="perk-modal-overlay" id="perkModalOverlay"></div>
  <div class="perk-modal-content" id="perkModalContent">
    <button class="perk-modal-close" id="perkModalClose">âœ•</button>
    <div id="perkModalBody">
      <!-- Perk detail will be rendered here -->
    </div>
  </div>
</div>

<script src="perky.js"></script>
<script>
const music = document.getElementById("bgMusic");
if (music) {
  music.volume = 0.4;

  const savedTime = parseFloat(localStorage.getItem("musicTime") || "0");
  if (!Number.isNaN(savedTime) && savedTime > 0) {
    try { music.currentTime = savedTime; } catch (_) {}
  }

  function safePlay() {
    const p = music.play();
    if (p && typeof p.catch === "function") p.catch(() => {});
  }

  safePlay();

  document.addEventListener(
    "click",
    () => {
      if (music.paused) safePlay();
    },
    { once: true }
  );

  setInterval(() => {
    if (!music.paused) {
      localStorage.setItem("musicTime", String(music.currentTime || 0));
    }
  }, 500);
}
</script>

<script src="mobile_lock.js"></script>
</body>
</html>