<!doctype html>
<html lang="cs">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">
  <title>Guild System</title>
  <link rel="stylesheet" href="guild.css">
  <link rel="stylesheet" href="menu.css">
  <link rel="stylesheet" href="mobile.css">
  <script src="supabase_stub.js"></script>
  <script src="menu.js" defer></script>
    <link rel="stylesheet" href="sf_scale.css">
    <script src="sf_scale.js"></script>
  <link rel="stylesheet" href="global.css">
<script src="lang_pack.js"></script>
</head>
<body>
<audio id="bgMusic" src="go.mp3" loop preload="auto"></audio>

<div class="layout">
  <!-- LEVÃ PANEL - KOMPAKTNÃ -->
  <aside class="left-panel">
  
</aside>

  <!-- GUILD AREA - SINGLE SCREEN -->
  <main class="guild-area">
    <div class="guild-title">ğŸ‘¥ GUILD SYSTEM ğŸ‘¥</div>

    <div class="guild-container" id="guildContainer">
      
      <!-- ÃšVODNÃ OBRAZOVKA - 2 TLAÄŒÃTKA -->
      <div class="guild-welcome" id="welcomeScreen">
        <div class="welcome-content">
          <div class="welcome-icon">ğŸ‘¥</div>
          <h2 class="welcome-heading">GUILD SYSTEM</h2>
          <p class="welcome-desc">PÅ™ipoj se k guildÄ› nebo zaloÅ¾ vlastnÃ­!</p>
          
          <div class="welcome-buttons">
            <button class="guild-main-btn search-btn" id="btnSearchGuild">
              <span class="btn-icon">ğŸ”</span>
              <span class="btn-text">NAJÃT GUILDU</span>
            </button>
            <button class="guild-main-btn create-btn" id="btnCreateGuildMain">
              <span class="btn-icon">ğŸ—ï¸</span>
              <span class="btn-text">ZALOÅ½IT GUILDU</span>
              <span class="btn-cost">ğŸš¬ 100</span>
            </button>
          </div>
        </div>
      </div>

      <!-- SEZNAM GUILD - KOMPAKTNÃ -->
      <div class="guild-browser" id="guildBrowser" style="display: none;">
        <div class="browser-header">
          <button class="back-btn" id="btnBackFromBrowser">â† ZPÄšT</button>
          <h2>ğŸ” GUILDY</h2>
          <input type="text" class="guild-search" id="guildSearch" placeholder="ğŸ” Hledat guildu...">
        </div>
        <div class="guild-list" id="guildList"></div>
      </div>

      <!-- MÃ GUILDA - SINGLE SCREEN LAYOUT -->
      <div class="my-guild-view" id="myGuildView" style="display: none;">
        <div class="guild-compact-layout">
          <!-- LEVÃ ÄŒÃST - INFO O GUILDÄš -->
          <div class="guild-info-panel">
            <div class="guild-header-compact" id="guildHeaderCompact"></div>
            <div class="guild-vault-compact" id="guildVaultCompact"></div>
            <div class="guild-perks-compact" id="guildPerksCompact"></div>
          </div>
          
          <!-- PRAVÃ ÄŒÃST - ÄŒLENOVÃ‰ + AKCE -->
          <div class="guild-members-panel">
            <div class="members-header">
              <h3>ğŸ‘¥ ÄŒLENOVÃ‰</h3>
              <div class="member-count" id="memberCount"></div>
            </div>
            <div class="members-list-compact" id="membersListCompact"></div>
            <div class="guild-actions-compact" id="guildActionsCompact"></div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Modal pro Guild Info -->
<div class="modal" id="infoModal">
  <div class="modal-content modal-large">
    <div class="modal-header">ğŸ“Š INFO O GUILDÄš</div>
    <div class="modal-body" id="infoModalBody"></div>
    <div class="modal-actions">
      <button class="guild-btn" id="btnCloseInfo">ZavÅ™Ã­t</button>
    </div>
  </div>
</div>

<!-- Modal pro Guild Cryptu (Boss Fight) -->
<div class="modal modal-boss" id="cryptaModal">
  <div class="modal-content modal-xlarge">
    <div class="modal-header">ğŸ›ï¸ GUILD CRYPTA</div>
    <div class="modal-body" id="cryptaModalBody">
      <div class="boss-fight-container">
        <div class="boss-section">
          <div class="boss-avatar" id="bossAvatar"></div>
          <div class="boss-name" id="bossName">BOSS</div>
          <div class="boss-health-bar">
            <div class="boss-health-fill" id="bossHealthFill"></div>
            <div class="boss-health-text" id="bossHealthText">100%</div>
          </div>
          <div class="boss-stats" id="bossStats"></div>
        </div>
        
        <div class="vs-divider">âš”ï¸ VS âš”ï¸</div>
        
        <div class="guild-fighters-section">
          <div class="fighters-title">ğŸ‘¥ BOJOVNÃCI GUILDY</div>
          <div class="fighters-list" id="fightersList"></div>
        </div>
      </div>
      
      <div class="boss-controls">
        <button class="guild-btn primary" id="btnAttackBoss">âš”ï¸ ZAÃšTOÄŒIT</button>
        <button class="guild-btn" id="btnCloseCrypta">â† ZpÄ›t</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal pro PvP Guild Battle -->
<div class="modal modal-boss" id="pvpModal">
  <div class="modal-content modal-xlarge">
    <div class="modal-header">âš”ï¸ GUILD BATTLE</div>
    <div class="modal-body" id="pvpModalBody">
      <div class="pvp-mode-select" id="pvpModeSelect">
        <button class="pvp-mode-btn attack-mode" id="btnPvpAttack">
          <div class="mode-icon">âš”ï¸</div>
          <div class="mode-title">ZAÃšTOÄŒIT</div>
          <div class="mode-desc">Vyber guildu a zaÃºtoÄ na ni</div>
        </button>
        <button class="pvp-mode-btn defend-mode" id="btnPvpDefend">
          <div class="mode-icon">ğŸ›¡ï¸</div>
          <div class="mode-title">BRÃNIT</div>
          <div class="mode-desc">Obrana proti ÃºtokÅ¯m</div>
        </button>
      </div>
      
      <div class="pvp-guild-select" id="pvpGuildSelect" style="display: none;">
        <div class="pvp-back-btn" id="btnPvpBack">â† ZpÄ›t</div>
        <div class="pvp-guilds-list" id="pvpGuildsList"></div>
      </div>
      
      <div class="pvp-battle-arena" id="pvpBattleArena" style="display: none;"></div>
    </div>
    <div class="modal-actions">
      <button class="guild-btn" id="btnClosePvp">ZavÅ™Ã­t</button>
    </div>
  </div>
</div>

<!-- Modal pro vytvoÅ™enÃ­ guildy -->
<div class="modal" id="createModal">
  <div class="modal-content">
    <div class="modal-header">ğŸ—ï¸ ZaloÅ¾it guildu</div>
    <div class="modal-body">
      <div class="modal-info">
        <p>ğŸ’° Cena: <strong>100 ğŸš¬ cigaret</strong></p>
      </div>
      <div class="input-group">
        <label>NÃ¡zev guildy</label>
        <input type="text" id="inputGuildName" maxlength="30" placeholder="NapÅ™. PANELAK ELITE">
      </div>
      <div class="input-group">
        <label>Popis</label>
        <textarea id="inputGuildDesc" maxlength="200" placeholder="Popis tvÃ© guildy..."></textarea>
      </div>
      <div class="input-group">
        <label>Emoji (symbol)</label>
        <input type="text" id="inputGuildEmoji" maxlength="2" placeholder="ğŸ°">
      </div>
    </div>
    <div class="modal-actions">
      <button class="guild-btn" id="btnCancelCreate">ZruÅ¡it</button>
      <button class="guild-btn" id="btnConfirmCreate">VytvoÅ™it</button>
    </div>
  </div>
</div>

<!-- Modal pro detail guildy pÅ™ed pÅ™ipojenÃ­m -->
<div class="modal" id="joinModal">
  <div class="modal-content modal-large">
    <div class="modal-header">ğŸ‘¥ Detail guildy</div>
    <div class="modal-body" id="joinModalBody"></div>
    <div class="modal-actions">
      <button class="guild-btn" id="btnCancelJoin">ZpÄ›t</button>
      <button class="guild-btn" id="btnConfirmJoin">âœ… PÅ™ipojit se</button>
    </div>
  </div>
</div>

<!-- Modal pro guild upgrade -->
<div class="modal" id="upgradeModal">
  <div class="modal-content">
    <div class="modal-header">â¬†ï¸ VYLEPÅ ENÃ GUILDY</div>
    <div class="modal-body" id="upgradeModalBody"></div>
    <div class="modal-actions">
      <button class="guild-btn" id="btnCancelUpgrade">ZpÄ›t</button>
      <button class="guild-btn" id="btnConfirmUpgrade">âœ… VYLEPÅ IT</button>
    </div>
  </div>
</div>

<script src="guild.js"></script>
<script>
const music = document.getElementById("bgMusic");
if (music) {
  music.volume = 0.4;

  const savedTime = parseFloat(localStorage.getItem("musicTime") || "0");
  if (!Number.isNaN(savedTime) && savedTime > 0) {
    try { music.currentTime = savedTime; } catch (_) {}
  }

  function safePlay() {
    const p = music.play();
    if (p && typeof p.catch === "function") p.catch(() => {});
  }

  safePlay();

  document.addEventListener(
    "click",
    () => {
      if (music.paused) safePlay();
    },
    { once: true }
  );

  setInterval(() => {
    if (!music.paused) {
      localStorage.setItem("musicTime", String(music.currentTime || 0));
    }
  }, 500);
}
</script>

<script src="mobile_lock.js"></script>
</body>
</html>