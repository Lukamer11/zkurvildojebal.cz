<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>Arena</title>
  <link rel="stylesheet" href="arena.css">
  <link rel="stylesheet" href="menu.css">
</head>
<body>
<audio id="bgMusic" src="go.mp3" loop preload="auto"></audio>

<div class="layout">
  <!-- ... celý layout zůstává stejný ... -->
</div>

<!-- ✅ SPRÁVNÉ POŘADÍ SCRIPTŮ (BEZ type="module") -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="items.js"></script>
<script src="gameState.js"></script>
<script src="arena.js"></script>

<!-- Music handling -->
<script>
const music = document.getElementById("bgMusic");

function safePlay(){
  if(!music) return;
  const p = music.play();
  if(p && typeof p.catch === 'function'){
    p.catch(() => {});
  }
}

if (localStorage.getItem("musicPlaying") === "true") {
  music.currentTime = parseFloat(localStorage.getItem("musicTime")) || 0;
  music.volume = 0.4;
  safePlay();
}

document.addEventListener("click", () => {
  if (music.paused) {
    safePlay();
    localStorage.setItem("musicPlaying", "true");
  }
}, { once: true });

setInterval(() => {
  if (!music.paused) {
    localStorage.setItem("musicTime", music.currentTime);
  }
}, 500);
</script>

</body>
</html>
